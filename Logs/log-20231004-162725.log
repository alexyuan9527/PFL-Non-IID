==================================================
Algorithm: Ditto
Dataset: cifar10
Number of classes: 10
Total number of clients: 20
Global rounds: 100
Backbone: cnn
Attackers: 6
Ditto lambda: 1.0
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Using device: cuda
Using DP: False
Auto break: False
Cuda device id: 0
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 20
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global models
Averaged Train Loss: 2.3018
Averaged Test Accurancy: 0.1120    Std Test Accurancy: 0.2085

Evaluate personalized models
Averaged Train Loss: 2.3018
Averaged Test Accurancy: 0.1120    Std Test Accurancy: 0.2085
------------------------- time cost ------------------------- 26.811829328536987

-------------Round number: 1-------------

Evaluate global models
Averaged Train Loss: 2.2790
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 2.7932
Averaged Test Accurancy: 0.7707    Std Test Accurancy: 0.1976
------------------------- time cost ------------------------- 27.696195125579834

-------------Round number: 2-------------

Evaluate global models
Averaged Train Loss: 2.2775
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 2.7033
Averaged Test Accurancy: 0.7804    Std Test Accurancy: 0.1917
------------------------- time cost ------------------------- 28.233699560165405

-------------Round number: 3-------------

Evaluate global models
Averaged Train Loss: 2.2758
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 2.3479
Averaged Test Accurancy: 0.7832    Std Test Accurancy: 0.1867
------------------------- time cost ------------------------- 29.0737521648407

-------------Round number: 4-------------

Evaluate global models
Averaged Train Loss: 2.2772
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.9924
Averaged Test Accurancy: 0.7826    Std Test Accurancy: 0.1844
------------------------- time cost ------------------------- 27.657667636871338

-------------Round number: 5-------------

Evaluate global models
Averaged Train Loss: 2.2763
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.6943
Averaged Test Accurancy: 0.7819    Std Test Accurancy: 0.1854
------------------------- time cost ------------------------- 28.975909948349

-------------Round number: 6-------------

Evaluate global models
Averaged Train Loss: 2.2771
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.4628
Averaged Test Accurancy: 0.7815    Std Test Accurancy: 0.1855
------------------------- time cost ------------------------- 29.92848014831543

-------------Round number: 7-------------

Evaluate global models
Averaged Train Loss: 2.2775
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.2896
Averaged Test Accurancy: 0.7818    Std Test Accurancy: 0.1842
------------------------- time cost ------------------------- 28.841010332107544

-------------Round number: 8-------------

Evaluate global models
Averaged Train Loss: 2.2780
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.1646
Averaged Test Accurancy: 0.7803    Std Test Accurancy: 0.1849
------------------------- time cost ------------------------- 27.76185441017151

-------------Round number: 9-------------

Evaluate global models
Averaged Train Loss: 2.2784
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.0763
Averaged Test Accurancy: 0.7796    Std Test Accurancy: 0.1859
------------------------- time cost ------------------------- 28.887067079544067

-------------Round number: 10-------------

Evaluate global models
Averaged Train Loss: 2.2775
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 1.0165
Averaged Test Accurancy: 0.7787    Std Test Accurancy: 0.1870
------------------------- time cost ------------------------- 36.32859945297241

-------------Round number: 11-------------

Evaluate global models
Averaged Train Loss: 2.2779
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9770
Averaged Test Accurancy: 0.7782    Std Test Accurancy: 0.1876
------------------------- time cost ------------------------- 42.843148708343506

-------------Round number: 12-------------

Evaluate global models
Averaged Train Loss: 2.2776
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9518
Averaged Test Accurancy: 0.7776    Std Test Accurancy: 0.1881
------------------------- time cost ------------------------- 42.857434034347534

-------------Round number: 13-------------

Evaluate global models
Averaged Train Loss: 2.2781
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9362
Averaged Test Accurancy: 0.7772    Std Test Accurancy: 0.1883
------------------------- time cost ------------------------- 30.45738196372986

-------------Round number: 14-------------

Evaluate global models
Averaged Train Loss: 2.2784
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9270
Averaged Test Accurancy: 0.7769    Std Test Accurancy: 0.1883
------------------------- time cost ------------------------- 28.343096494674683

-------------Round number: 15-------------

Evaluate global models
Averaged Train Loss: 2.2787
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9214
Averaged Test Accurancy: 0.7764    Std Test Accurancy: 0.1888
------------------------- time cost ------------------------- 26.990988731384277

-------------Round number: 16-------------

Evaluate global models
Averaged Train Loss: 2.2787
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9180
Averaged Test Accurancy: 0.7757    Std Test Accurancy: 0.1890
------------------------- time cost ------------------------- 27.828113317489624

-------------Round number: 17-------------

Evaluate global models
Averaged Train Loss: 2.2790
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9165
Averaged Test Accurancy: 0.7754    Std Test Accurancy: 0.1891
------------------------- time cost ------------------------- 28.95066523551941

-------------Round number: 18-------------

Evaluate global models
Averaged Train Loss: 2.2793
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9156
Averaged Test Accurancy: 0.7751    Std Test Accurancy: 0.1891
------------------------- time cost ------------------------- 27.540611267089844

-------------Round number: 19-------------

Evaluate global models
Averaged Train Loss: 2.2790
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9153
Averaged Test Accurancy: 0.7748    Std Test Accurancy: 0.1891
------------------------- time cost ------------------------- 27.224464178085327

-------------Round number: 20-------------

Evaluate global models
Averaged Train Loss: 2.2790
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9152
Averaged Test Accurancy: 0.7747    Std Test Accurancy: 0.1892
------------------------- time cost ------------------------- 28.756580591201782

-------------Round number: 21-------------

Evaluate global models
Averaged Train Loss: 2.2794
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9149
Averaged Test Accurancy: 0.7746    Std Test Accurancy: 0.1892
------------------------- time cost ------------------------- 27.43530774116516

-------------Round number: 22-------------

Evaluate global models
Averaged Train Loss: 2.2790
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9154
Averaged Test Accurancy: 0.7744    Std Test Accurancy: 0.1892
------------------------- time cost ------------------------- 27.530686855316162

-------------Round number: 23-------------

Evaluate global models
Averaged Train Loss: 2.2801
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9153
Averaged Test Accurancy: 0.7741    Std Test Accurancy: 0.1893
------------------------- time cost ------------------------- 28.27483630180359

-------------Round number: 24-------------

Evaluate global models
Averaged Train Loss: 2.2796
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9155
Averaged Test Accurancy: 0.7736    Std Test Accurancy: 0.1896
------------------------- time cost ------------------------- 28.154312133789062

-------------Round number: 25-------------

Evaluate global models
Averaged Train Loss: 2.2796
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9158
Averaged Test Accurancy: 0.7730    Std Test Accurancy: 0.1893
------------------------- time cost ------------------------- 34.31979274749756

-------------Round number: 26-------------

Evaluate global models
Averaged Train Loss: 2.2799
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9157
Averaged Test Accurancy: 0.7728    Std Test Accurancy: 0.1891
------------------------- time cost ------------------------- 43.462441205978394

-------------Round number: 27-------------

Evaluate global models
Averaged Train Loss: 2.2796
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9162
Averaged Test Accurancy: 0.7728    Std Test Accurancy: 0.1891
------------------------- time cost ------------------------- 45.09735465049744

-------------Round number: 28-------------

Evaluate global models
Averaged Train Loss: 2.2798
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9160
Averaged Test Accurancy: 0.7724    Std Test Accurancy: 0.1892
------------------------- time cost ------------------------- 43.76921200752258

-------------Round number: 29-------------

Evaluate global models
Averaged Train Loss: 2.2802
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9165
Averaged Test Accurancy: 0.7718    Std Test Accurancy: 0.1895
------------------------- time cost ------------------------- 43.92977857589722

-------------Round number: 30-------------

Evaluate global models
Averaged Train Loss: 2.2804
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9166
Averaged Test Accurancy: 0.7716    Std Test Accurancy: 0.1897
------------------------- time cost ------------------------- 44.05048656463623

-------------Round number: 31-------------

Evaluate global models
Averaged Train Loss: 2.2794
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9166
Averaged Test Accurancy: 0.7714    Std Test Accurancy: 0.1897
------------------------- time cost ------------------------- 44.213608264923096

-------------Round number: 32-------------

Evaluate global models
Averaged Train Loss: 2.2802
Averaged Test Accurancy: 0.1009    Std Test Accurancy: 0.1425

Evaluate personalized models
Averaged Train Loss: 0.9166
Averaged Test Accurancy: 0.7712    Std Test Accurancy: 0.1895
Traceback (most recent call last):
  File "main.py", line 515, in <module>
    run(args)
  File "main.py", line 319, in run
    server.train()
  File "E:\Documents\GitHub\PFL-Non-IID\system\flcore\servers\serverditto.py", line 46, in train
    client.ptrain()
  File "E:\Documents\GitHub\PFL-Non-IID\system\flcore\clients\clientditto.py", line 106, in ptrain
    self.optimizer_per.step(self.model.parameters(), self.device)
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\torch\optim\lr_scheduler.py", line 68, in wrapper
    return wrapped(*args, **kwargs)
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\torch\optim\optimizer.py", line 140, in wrapper
    out = func(*args, **kwargs)
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\torch\autograd\grad_mode.py", line 27, in decorate_context
    return func(*args, **kwargs)
  File "E:\Documents\GitHub\PFL-Non-IID\system\flcore\optimizers\fedoptimizer.py", line 74, in step
    d_p = p.grad.data + group['mu'] * (p.data - g.data)
KeyboardInterrupt
