==================================================
Algorithm: Ditto
Attackers: 4
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Total number of clients: 10
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: mnist
Number of classes: 10
Backbone: cnn
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 20
Cuda device id: 0
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global models
Averaged Train Loss: 2.3046
Averaged Test Accurancy: 0.0806    Std Test Accurancy: 0.0636

Evaluate personalized models
Averaged Train Loss: 2.3046
Averaged Test Accurancy: 0.0806    Std Test Accurancy: 0.0636
------------------------- time cost ------------------------- 40.04445171356201

-------------Round number: 1-------------

Evaluate global models
Averaged Train Loss: 2.1371
Averaged Test Accurancy: 0.5027    Std Test Accurancy: 0.3731

Evaluate personalized models
Averaged Train Loss: 0.1600
Averaged Test Accurancy: 0.9515    Std Test Accurancy: 0.0960
------------------------- time cost ------------------------- 38.970439195632935

-------------Round number: 2-------------

Evaluate global models
Averaged Train Loss: 2.0569
Averaged Test Accurancy: 0.5148    Std Test Accurancy: 0.3796

Evaluate personalized models
Averaged Train Loss: 0.1035
Averaged Test Accurancy: 0.9659    Std Test Accurancy: 0.0833
------------------------- time cost ------------------------- 39.01400566101074

-------------Round number: 3-------------

Evaluate global models
Averaged Train Loss: 2.0110
Averaged Test Accurancy: 0.5222    Std Test Accurancy: 0.3797

Evaluate personalized models
Averaged Train Loss: 0.0794
Averaged Test Accurancy: 0.9734    Std Test Accurancy: 0.0697
------------------------- time cost ------------------------- 38.88508462905884

-------------Round number: 4-------------

Evaluate global models
Averaged Train Loss: 1.9973
Averaged Test Accurancy: 0.5379    Std Test Accurancy: 0.3753

Evaluate personalized models
Averaged Train Loss: 0.0642
Averaged Test Accurancy: 0.9783    Std Test Accurancy: 0.0569
------------------------- time cost ------------------------- 39.01874494552612

-------------Round number: 5-------------

Evaluate global models
Averaged Train Loss: 1.9859
Averaged Test Accurancy: 0.5437    Std Test Accurancy: 0.3718

Evaluate personalized models
Averaged Train Loss: 0.0545
Averaged Test Accurancy: 0.9818    Std Test Accurancy: 0.0392
------------------------- time cost ------------------------- 38.97374153137207

-------------Round number: 6-------------

Evaluate global models
Averaged Train Loss: 1.9846
Averaged Test Accurancy: 0.5418    Std Test Accurancy: 0.3733

Evaluate personalized models
Averaged Train Loss: 0.0479
Averaged Test Accurancy: 0.9845    Std Test Accurancy: 0.0291
------------------------- time cost ------------------------- 39.03645157814026

-------------Round number: 7-------------

Evaluate global models
Averaged Train Loss: 1.9789
Averaged Test Accurancy: 0.5521    Std Test Accurancy: 0.3710

Evaluate personalized models
Averaged Train Loss: 0.0431
Averaged Test Accurancy: 0.9858    Std Test Accurancy: 0.0223
------------------------- time cost ------------------------- 36.59191560745239

-------------Round number: 8-------------

Evaluate global models
Averaged Train Loss: 1.9792
Averaged Test Accurancy: 0.5564    Std Test Accurancy: 0.3701

Evaluate personalized models
Averaged Train Loss: 0.0395
Averaged Test Accurancy: 0.9867    Std Test Accurancy: 0.0190
------------------------- time cost ------------------------- 35.14012050628662

-------------Round number: 9-------------

Evaluate global models
Averaged Train Loss: 1.9809
Averaged Test Accurancy: 0.5528    Std Test Accurancy: 0.3713

Evaluate personalized models
Averaged Train Loss: 0.0366
Averaged Test Accurancy: 0.9871    Std Test Accurancy: 0.0184
------------------------- time cost ------------------------- 35.42128586769104

-------------Round number: 10-------------

Evaluate global models
Averaged Train Loss: 1.9758
Averaged Test Accurancy: 0.5519    Std Test Accurancy: 0.3704

Evaluate personalized models
Averaged Train Loss: 0.0342
Averaged Test Accurancy: 0.9878    Std Test Accurancy: 0.0195
------------------------- time cost ------------------------- 36.238365173339844

-------------Round number: 11-------------

Evaluate global models
Averaged Train Loss: 1.9767
Averaged Test Accurancy: 0.5566    Std Test Accurancy: 0.3698

Evaluate personalized models
Averaged Train Loss: 0.0322
Averaged Test Accurancy: 0.9883    Std Test Accurancy: 0.0180
------------------------- time cost ------------------------- 35.1690993309021

-------------Round number: 12-------------

Evaluate global models
Averaged Train Loss: 1.9750
Averaged Test Accurancy: 0.5549    Std Test Accurancy: 0.3716

Evaluate personalized models
Averaged Train Loss: 0.0304
Averaged Test Accurancy: 0.9886    Std Test Accurancy: 0.0164
------------------------- time cost ------------------------- 37.89151859283447

-------------Round number: 13-------------

Evaluate global models
Averaged Train Loss: 1.9748
Averaged Test Accurancy: 0.5554    Std Test Accurancy: 0.3716

Evaluate personalized models
Averaged Train Loss: 0.0289
Averaged Test Accurancy: 0.9890    Std Test Accurancy: 0.0157
------------------------- time cost ------------------------- 39.105907917022705

-------------Round number: 14-------------

Evaluate global models
Averaged Train Loss: 1.9773
Averaged Test Accurancy: 0.5507    Std Test Accurancy: 0.3698

Evaluate personalized models
Averaged Train Loss: 0.0274
Averaged Test Accurancy: 0.9899    Std Test Accurancy: 0.0144
------------------------- time cost ------------------------- 39.058199644088745

-------------Round number: 15-------------

Evaluate global models
Averaged Train Loss: 1.9768
Averaged Test Accurancy: 0.5529    Std Test Accurancy: 0.3717

Evaluate personalized models
Averaged Train Loss: 0.0261
Averaged Test Accurancy: 0.9900    Std Test Accurancy: 0.0137
------------------------- time cost ------------------------- 38.70732665061951

-------------Round number: 16-------------

Evaluate global models
Averaged Train Loss: 1.9788
Averaged Test Accurancy: 0.5570    Std Test Accurancy: 0.3688

Evaluate personalized models
Averaged Train Loss: 0.0250
Averaged Test Accurancy: 0.9901    Std Test Accurancy: 0.0132
------------------------- time cost ------------------------- 38.91340184211731

-------------Round number: 17-------------

Evaluate global models
Averaged Train Loss: 1.9764
Averaged Test Accurancy: 0.5562    Std Test Accurancy: 0.3698

Evaluate personalized models
Averaged Train Loss: 0.0239
Averaged Test Accurancy: 0.9902    Std Test Accurancy: 0.0132
------------------------- time cost ------------------------- 38.94485950469971

-------------Round number: 18-------------

Evaluate global models
Averaged Train Loss: 1.9784
Averaged Test Accurancy: 0.5559    Std Test Accurancy: 0.3696

Evaluate personalized models
Averaged Train Loss: 0.0229
Averaged Test Accurancy: 0.9904    Std Test Accurancy: 0.0133
------------------------- time cost ------------------------- 38.93257689476013

-------------Round number: 19-------------

Evaluate global models
Averaged Train Loss: 1.9785
Averaged Test Accurancy: 0.5556    Std Test Accurancy: 0.3700

Evaluate personalized models
Averaged Train Loss: 0.0219
Averaged Test Accurancy: 0.9906    Std Test Accurancy: 0.0126
------------------------- time cost ------------------------- 38.84752178192139

-------------Round number: 20-------------

Evaluate global models
Averaged Train Loss: 1.9723
Averaged Test Accurancy: 0.5546    Std Test Accurancy: 0.3691

Evaluate personalized models
Averaged Train Loss: 0.0211
Averaged Test Accurancy: 0.9910    Std Test Accurancy: 0.0119
------------------------- time cost ------------------------- 39.21103835105896

Best accuracy.
0.990982528649258

Average time cost per round.
38.10358026027679
File path: E:/Documents/GitHub/results/mnist_Ditto_¦Ë_0.001_attackers_4_0.h5

Average time cost: 1106.43s.
Traceback (most recent call last):
  File "main.py", line 514, in <module>
    run(args)
  File "main.py", line 327, in run
    average_data(dataset=args.dataset, algorithm=args.algorithm, goal=args.goal, times=args.times)
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 7, in average_data
    test_acc = get_all_results_for_one_algo(algorithm, dataset, goal, times)
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 22, in get_all_results_for_one_algo
    test_acc.append(np.array(read_data_then_delete(file_name, delete=False)))
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 30, in read_data_then_delete
    with h5py.File(file_path, 'r') as hf:
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\h5py\_hl\files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\h5py\_hl\files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py\_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py\_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py\h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '../results/mnist_Ditto_¦Ë_0.001_attackers_4_0.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
