==================================================
Algorithm: Ditto
Dataset: cifar10
Number of classes: 10
Total number of clients: 10
Global rounds: 50
Backbone: cnn
Attackers: 4
Ditto lambda: 0.001
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Using device: cuda
Using DP: False
Auto break: False
Cuda device id: 0
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(3, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1600, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global models
Averaged Train Loss: 2.3001
Averaged Test Accurancy: 0.0987    Std Test Accurancy: 0.0943

Evaluate personalized models
Averaged Train Loss: 2.3001
Averaged Test Accurancy: 0.0987    Std Test Accurancy: 0.0943
------------------------- time cost ------------------------- 20.66303014755249

-------------Round number: 1-------------

Evaluate global models
Averaged Train Loss: 2.2627
Averaged Test Accurancy: 0.1822    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.6198
Averaged Test Accurancy: 0.7619    Std Test Accurancy: 0.1702
------------------------- time cost ------------------------- 19.1446053981781

-------------Round number: 2-------------

Evaluate global models
Averaged Train Loss: 2.2608
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.5469
Averaged Test Accurancy: 0.7959    Std Test Accurancy: 0.1591
------------------------- time cost ------------------------- 20.95134425163269

-------------Round number: 3-------------

Evaluate global models
Averaged Train Loss: 2.2591
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.4922
Averaged Test Accurancy: 0.8226    Std Test Accurancy: 0.1474
------------------------- time cost ------------------------- 20.861498594284058

-------------Round number: 4-------------

Evaluate global models
Averaged Train Loss: 2.2564
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.4591
Averaged Test Accurancy: 0.8366    Std Test Accurancy: 0.1440
------------------------- time cost ------------------------- 21.864644050598145

-------------Round number: 5-------------

Evaluate global models
Averaged Train Loss: 2.2565
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.4365
Averaged Test Accurancy: 0.8434    Std Test Accurancy: 0.1433
------------------------- time cost ------------------------- 22.101175546646118

-------------Round number: 6-------------

Evaluate global models
Averaged Train Loss: 2.2569
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.4176
Averaged Test Accurancy: 0.8484    Std Test Accurancy: 0.1428
------------------------- time cost ------------------------- 21.06490159034729

-------------Round number: 7-------------

Evaluate global models
Averaged Train Loss: 2.2568
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.4010
Averaged Test Accurancy: 0.8502    Std Test Accurancy: 0.1423
------------------------- time cost ------------------------- 20.881698846817017

-------------Round number: 8-------------

Evaluate global models
Averaged Train Loss: 2.2565
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3854
Averaged Test Accurancy: 0.8554    Std Test Accurancy: 0.1419
------------------------- time cost ------------------------- 20.59957456588745

-------------Round number: 9-------------

Evaluate global models
Averaged Train Loss: 2.2577
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3713
Averaged Test Accurancy: 0.8601    Std Test Accurancy: 0.1416
------------------------- time cost ------------------------- 20.532735347747803

-------------Round number: 10-------------

Evaluate global models
Averaged Train Loss: 2.2567
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3581
Averaged Test Accurancy: 0.8631    Std Test Accurancy: 0.1407
------------------------- time cost ------------------------- 21.614418506622314

-------------Round number: 11-------------

Evaluate global models
Averaged Train Loss: 2.2572
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3462
Averaged Test Accurancy: 0.8672    Std Test Accurancy: 0.1421
------------------------- time cost ------------------------- 20.45463752746582

-------------Round number: 12-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3354
Averaged Test Accurancy: 0.8707    Std Test Accurancy: 0.1408
------------------------- time cost ------------------------- 20.357133388519287

-------------Round number: 13-------------

Evaluate global models
Averaged Train Loss: 2.2570
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3249
Averaged Test Accurancy: 0.8718    Std Test Accurancy: 0.1409
------------------------- time cost ------------------------- 21.395440340042114

-------------Round number: 14-------------

Evaluate global models
Averaged Train Loss: 2.2574
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3145
Averaged Test Accurancy: 0.8739    Std Test Accurancy: 0.1404
------------------------- time cost ------------------------- 21.108978033065796

-------------Round number: 15-------------

Evaluate global models
Averaged Train Loss: 2.2574
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.3051
Averaged Test Accurancy: 0.8750    Std Test Accurancy: 0.1415
------------------------- time cost ------------------------- 21.147456645965576

-------------Round number: 16-------------

Evaluate global models
Averaged Train Loss: 2.2570
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2957
Averaged Test Accurancy: 0.8768    Std Test Accurancy: 0.1414
------------------------- time cost ------------------------- 21.70656728744507

-------------Round number: 17-------------

Evaluate global models
Averaged Train Loss: 2.2569
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2864
Averaged Test Accurancy: 0.8786    Std Test Accurancy: 0.1410
------------------------- time cost ------------------------- 21.67251992225647

-------------Round number: 18-------------

Evaluate global models
Averaged Train Loss: 2.2570
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2769
Averaged Test Accurancy: 0.8803    Std Test Accurancy: 0.1392
------------------------- time cost ------------------------- 20.874778032302856

-------------Round number: 19-------------

Evaluate global models
Averaged Train Loss: 2.2569
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2676
Averaged Test Accurancy: 0.8817    Std Test Accurancy: 0.1391
------------------------- time cost ------------------------- 20.55874752998352

-------------Round number: 20-------------

Evaluate global models
Averaged Train Loss: 2.2567
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2582
Averaged Test Accurancy: 0.8820    Std Test Accurancy: 0.1402
------------------------- time cost ------------------------- 20.1874897480011

-------------Round number: 21-------------

Evaluate global models
Averaged Train Loss: 2.2576
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2495
Averaged Test Accurancy: 0.8831    Std Test Accurancy: 0.1410
------------------------- time cost ------------------------- 20.963759422302246

-------------Round number: 22-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2409
Averaged Test Accurancy: 0.8830    Std Test Accurancy: 0.1400
------------------------- time cost ------------------------- 21.96162509918213

-------------Round number: 23-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2320
Averaged Test Accurancy: 0.8840    Std Test Accurancy: 0.1369
------------------------- time cost ------------------------- 21.91402578353882

-------------Round number: 24-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2235
Averaged Test Accurancy: 0.8836    Std Test Accurancy: 0.1370
------------------------- time cost ------------------------- 21.541598081588745

-------------Round number: 25-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2145
Averaged Test Accurancy: 0.8834    Std Test Accurancy: 0.1363
------------------------- time cost ------------------------- 21.159759521484375

-------------Round number: 26-------------

Evaluate global models
Averaged Train Loss: 2.2575
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.2058
Averaged Test Accurancy: 0.8844    Std Test Accurancy: 0.1366
------------------------- time cost ------------------------- 20.812743663787842

-------------Round number: 27-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1973
Averaged Test Accurancy: 0.8840    Std Test Accurancy: 0.1361
------------------------- time cost ------------------------- 21.299567222595215

-------------Round number: 28-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1891
Averaged Test Accurancy: 0.8835    Std Test Accurancy: 0.1368
------------------------- time cost ------------------------- 21.06769037246704

-------------Round number: 29-------------

Evaluate global models
Averaged Train Loss: 2.2574
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1809
Averaged Test Accurancy: 0.8840    Std Test Accurancy: 0.1391
------------------------- time cost ------------------------- 21.484535455703735

-------------Round number: 30-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1723
Averaged Test Accurancy: 0.8851    Std Test Accurancy: 0.1371
------------------------- time cost ------------------------- 21.514528036117554

-------------Round number: 31-------------

Evaluate global models
Averaged Train Loss: 2.2568
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1646
Averaged Test Accurancy: 0.8854    Std Test Accurancy: 0.1370
------------------------- time cost ------------------------- 20.999988079071045

-------------Round number: 32-------------

Evaluate global models
Averaged Train Loss: 2.2572
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1572
Averaged Test Accurancy: 0.8849    Std Test Accurancy: 0.1365
------------------------- time cost ------------------------- 21.03731679916382

-------------Round number: 33-------------

Evaluate global models
Averaged Train Loss: 2.2576
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1509
Averaged Test Accurancy: 0.8855    Std Test Accurancy: 0.1342
------------------------- time cost ------------------------- 21.047650814056396

-------------Round number: 34-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1448
Averaged Test Accurancy: 0.8856    Std Test Accurancy: 0.1345
------------------------- time cost ------------------------- 20.85368776321411

-------------Round number: 35-------------

Evaluate global models
Averaged Train Loss: 2.2569
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1377
Averaged Test Accurancy: 0.8857    Std Test Accurancy: 0.1337
------------------------- time cost ------------------------- 21.219528913497925

-------------Round number: 36-------------

Evaluate global models
Averaged Train Loss: 2.2573
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1321
Averaged Test Accurancy: 0.8847    Std Test Accurancy: 0.1338
------------------------- time cost ------------------------- 21.775212287902832

-------------Round number: 37-------------

Evaluate global models
Averaged Train Loss: 2.2575
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1249
Averaged Test Accurancy: 0.8849    Std Test Accurancy: 0.1341
------------------------- time cost ------------------------- 20.54002833366394

-------------Round number: 38-------------

Evaluate global models
Averaged Train Loss: 2.2569
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1197
Averaged Test Accurancy: 0.8849    Std Test Accurancy: 0.1356
------------------------- time cost ------------------------- 20.937169790267944

-------------Round number: 39-------------

Evaluate global models
Averaged Train Loss: 2.2574
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1146
Averaged Test Accurancy: 0.8851    Std Test Accurancy: 0.1360
------------------------- time cost ------------------------- 20.90083932876587

-------------Round number: 40-------------

Evaluate global models
Averaged Train Loss: 2.2574
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1082
Averaged Test Accurancy: 0.8857    Std Test Accurancy: 0.1377
------------------------- time cost ------------------------- 20.31872057914734

-------------Round number: 41-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.1024
Averaged Test Accurancy: 0.8868    Std Test Accurancy: 0.1375
------------------------- time cost ------------------------- 20.851237058639526

-------------Round number: 42-------------

Evaluate global models
Averaged Train Loss: 2.2572
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0974
Averaged Test Accurancy: 0.8868    Std Test Accurancy: 0.1379
------------------------- time cost ------------------------- 21.21880269050598

-------------Round number: 43-------------

Evaluate global models
Averaged Train Loss: 2.2572
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0927
Averaged Test Accurancy: 0.8870    Std Test Accurancy: 0.1383
------------------------- time cost ------------------------- 20.74622392654419

-------------Round number: 44-------------

Evaluate global models
Averaged Train Loss: 2.2572
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0888
Averaged Test Accurancy: 0.8870    Std Test Accurancy: 0.1376
------------------------- time cost ------------------------- 20.648357391357422

-------------Round number: 45-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0854
Averaged Test Accurancy: 0.8872    Std Test Accurancy: 0.1377
------------------------- time cost ------------------------- 20.76980948448181

-------------Round number: 46-------------

Evaluate global models
Averaged Train Loss: 2.2575
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0824
Averaged Test Accurancy: 0.8865    Std Test Accurancy: 0.1352
------------------------- time cost ------------------------- 20.795305967330933

-------------Round number: 47-------------

Evaluate global models
Averaged Train Loss: 2.2577
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0800
Averaged Test Accurancy: 0.8871    Std Test Accurancy: 0.1348
------------------------- time cost ------------------------- 21.457309007644653

-------------Round number: 48-------------

Evaluate global models
Averaged Train Loss: 2.2571
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0774
Averaged Test Accurancy: 0.8870    Std Test Accurancy: 0.1352
------------------------- time cost ------------------------- 20.705926179885864

-------------Round number: 49-------------

Evaluate global models
Averaged Train Loss: 2.2578
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0748
Averaged Test Accurancy: 0.8872    Std Test Accurancy: 0.1353
------------------------- time cost ------------------------- 21.46273636817932

-------------Round number: 50-------------

Evaluate global models
Averaged Train Loss: 2.2570
Averaged Test Accurancy: 0.1810    Std Test Accurancy: 0.2203

Evaluate personalized models
Averaged Train Loss: 0.0726
Averaged Test Accurancy: 0.8873    Std Test Accurancy: 0.1349
------------------------- time cost ------------------------- 27.736328125

Best accuracy.
0.8873414573489182

Average time cost per round.
21.176447134017945
File path: E:/Documents/GitHub/results/cifar10_Ditto_¦Ë_0.001_attackers_4_0.h5

Average time cost: 1094.37s.
Traceback (most recent call last):
  File "main.py", line 515, in <module>
    run(args)
  File "main.py", line 327, in run
    average_data(dataset=args.dataset, algorithm=args.algorithm, goal=args.goal, times=args.times)
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 7, in average_data
    test_acc = get_all_results_for_one_algo(algorithm, dataset, goal, times)
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 22, in get_all_results_for_one_algo
    test_acc.append(np.array(read_data_then_delete(file_name, delete=False)))
  File "E:\Documents\GitHub\PFL-Non-IID\system\utils\result_utils.py", line 30, in read_data_then_delete
    with h5py.File(file_path, 'r') as hf:
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\h5py\_hl\files.py", line 533, in __init__
    fid = make_fid(name, mode, userblock_size, fapl, fcpl, swmr=swmr)
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\h5py\_hl\files.py", line 226, in make_fid
    fid = h5f.open(name, flags, fapl=fapl)
  File "h5py\_objects.pyx", line 54, in h5py._objects.with_phil.wrapper
  File "h5py\_objects.pyx", line 55, in h5py._objects.with_phil.wrapper
  File "h5py\h5f.pyx", line 106, in h5py.h5f.open
FileNotFoundError: [Errno 2] Unable to open file (unable to open file: name = '../results/cifar10_Ditto_¦Ë_0.001_attackers_4_0.h5', errno = 2, error message = 'No such file or directory', flags = 0, o_flags = 0)
