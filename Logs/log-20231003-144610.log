==================================================
Algorithm: Ditto
Local batch size: 10
Local steps: 1
Local learing rate: 0.005
Local learing rate decay: False
Total number of clients: 10
Clients join in each round: 1.0
Clients randomly join: False
Client drop rate: 0.0
Client select regarding time: False
Running times: 1
Dataset: mnist
Number of classes: 10
Backbone: cnn
Using device: cuda
Using DP: False
Auto break: False
Global rounds: 20
Cuda device id: 0
DLG attack: False
Total number of new clients: 0
Fine tuning epoches on new clients: 0
==================================================

============= Running time: 0th =============
Creating server and clients ...
FedAvgCNN(
  (conv1): Sequential(
    (0): Conv2d(1, 32, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (conv2): Sequential(
    (0): Conv2d(32, 64, kernel_size=(5, 5), stride=(1, 1))
    (1): ReLU(inplace=True)
    (2): MaxPool2d(kernel_size=(2, 2), stride=(2, 2), padding=0, dilation=1, ceil_mode=False)
  )
  (fc1): Sequential(
    (0): Linear(in_features=1024, out_features=512, bias=True)
    (1): ReLU(inplace=True)
  )
  (fc): Linear(in_features=512, out_features=10, bias=True)
)

Join ratio / total clients: 1.0 / 10
Finished creating server and clients.

-------------Round number: 0-------------

Evaluate global models
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0571    Std Test Accurancy: 0.0535

Evaluate personalized models
Averaged Train Loss: 2.3125
Averaged Test Accurancy: 0.0571    Std Test Accurancy: 0.0535
------------------------- time cost ------------------------- 43.47064185142517

-------------Round number: 1-------------

Evaluate global models
Averaged Train Loss: 2.0347
Averaged Test Accurancy: 0.4650    Std Test Accurancy: 0.3137

Evaluate personalized models
Averaged Train Loss: 0.7966
Averaged Test Accurancy: 0.8930    Std Test Accurancy: 0.0809
------------------------- time cost ------------------------- 33.548333168029785

-------------Round number: 2-------------

Evaluate global models
Averaged Train Loss: 1.6182
Averaged Test Accurancy: 0.5383    Std Test Accurancy: 0.3067

Evaluate personalized models
Averaged Train Loss: 0.5337
Averaged Test Accurancy: 0.9405    Std Test Accurancy: 0.0642
Traceback (most recent call last):
  File "main.py", line 512, in <module>
    run(args)
  File "main.py", line 319, in run
    server.train()
  File "E:\Documents\GitHub\PFL-Non-IID\system\flcore\servers\serverditto.py", line 42, in train
    client.ptrain()
  File "E:\Documents\GitHub\PFL-Non-IID\system\flcore\clients\clientditto.py", line 105, in ptrain
    loss.backward()
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\torch\_tensor.py", line 489, in backward
    self, gradient, retain_graph, create_graph, inputs=inputs
  File "D:\Software\Anaconda\envs\pfl\lib\site-packages\torch\autograd\__init__.py", line 199, in backward
    allow_unreachable=True, accumulate_grad=True)  # Calls into the C++ engine to run the backward pass
KeyboardInterrupt
